import{r as h,a as N,u as g,j as r,b as w}from"./index-BzNwyTTe.js";import{u as v,L as j,E as b,y,c as C,a as o,b as B}from"./ReactToastify-C30oUaT2.js";import{E as f}from"./eye-B-AfLG2Q.js";const $=()=>{const[p,l]=h.useState(!1),[n,d]=h.useState(null);return{register:async x=>{var t,m,e,c,a;try{return l(!0),d(null),(await N.post("http://localhost:5000/api/v1/auth/register",x)).data}catch(s){const u=(m=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:m.errors;return console.error("🛑 Full backend validation:",u||((e=s==null?void 0:s.response)==null?void 0:e.data)),d(((a=(c=s==null?void 0:s.response)==null?void 0:c.data)==null?void 0:a.message)||"حدث خطأ أثناء التسجيل"),null}finally{l(!1)}},loading:p,error:n}},P=C({firstName:o().trim().min(3,"يجب أن لا يقل الاسم عن 3 أحرف").max(33).required("الاسم الأول مطلوب"),lastName:o().trim().min(3).max(33).required("الاسم الأخير مطلوب"),email:o().email("بريد إلكتروني غير صالح").matches(/^[\w-.]+@([\w-]+\.)+(com|net|org|pro|eg|sa)$/i,"البريد الإلكتروني يجب أن ينتهي بـ .com أو .net أو .org أو .pro أو .eg أو .sa").required("البريد الإلكتروني مطلوب"),password:o().matches(/^(?=.*[a-zA-Z])(?=.*[0-9]).{8,}$/,"كلمة المرور يجب أن تحتوي على أحرف وأرقام و 8 أحرف على الأقل").min(8).max(44).required("كلمة المرور مطلوبة"),confirmPassword:o().oneOf([B("password"),null],"كلمتا المرور غير متطابقتين").required("تأكيد كلمة المرور مطلوب"),phone:o()}),q=()=>{const{register:p,loading:l,error:n}=$(),d=g(),[i,x]=h.useState(!1),[t,m]=h.useState(!1),e=v({initialValues:{firstName:"",lastName:"",email:"",password:"",confirmPassword:"",phone:""},validationSchema:P,onSubmit:async c=>{var u;const a={...c};(u=a.phone)!=null&&u.trim()?a.phone.startsWith("+2")||(a.phone=`+2${a.phone}`):delete a.phone;const s=await p(a);s!=null&&s.success&&(y.success("تم التسجيل بنجاح، تحقق من بريدك الإلكتروني"),setTimeout(()=>d("/login"),2e3))}});return r.jsxs("div",{className:"min-h-screen max-w-md mx-auto px-4 py-12 text-center",children:[r.jsx(j,{position:"bottom-left",rtl:!0,theme:"colored"}),r.jsx("h2",{className:"text-3xl font-bold text-blue-800 mb-6",children:"إنشاء حساب جديد"}),n&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-sm text-right",dir:"rtl",children:["⚠️ ",n]}),r.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4 text-right",dir:"rtl",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("input",{name:"firstName",type:"text",placeholder:"الاسم الأول",className:`p-3 border rounded w-full ${e.touched.firstName&&e.errors.firstName?"border-red-500":"border-blue-800"}`,value:e.values.firstName,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.firstName&&e.errors.firstName&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.firstName})]}),r.jsxs("div",{children:[r.jsx("input",{name:"lastName",type:"text",placeholder:"الاسم الأخير",className:`p-3 border rounded w-full ${e.touched.lastName&&e.errors.lastName?"border-red-500":"border-blue-800"}`,value:e.values.lastName,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.lastName&&e.errors.lastName&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.lastName})]})]}),r.jsx("input",{name:"email",type:"email",placeholder:"البريد الإلكتروني",className:`w-full p-3 border rounded ${e.touched.email&&e.errors.email?"border-red-500":"border-blue-800"}`,value:e.values.email,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.email&&e.errors.email&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.email}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{name:"password",type:i?"text":"password",placeholder:"كلمة المرور",className:`w-full p-3 border rounded pr-10 ${e.touched.password&&e.errors.password?"border-red-500":"border-blue-800"}`,value:e.values.password,onChange:e.handleChange,onBlur:e.handleBlur}),r.jsx("button",{type:"button",onClick:()=>x(!i),className:"absolute left-3 top-3 text-gray-600",children:i?r.jsx(b,{size:18}):r.jsx(f,{size:18})})]}),e.touched.password&&e.errors.password&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.password}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{name:"confirmPassword",type:t?"text":"password",placeholder:"تأكيد كلمة المرور",className:`w-full p-3 border rounded pr-10 ${e.touched.confirmPassword&&e.errors.confirmPassword?"border-red-500":"border-blue-800"}`,value:e.values.confirmPassword,onChange:e.handleChange,onBlur:e.handleBlur}),r.jsx("button",{type:"button",onClick:()=>m(!t),className:"absolute left-3 top-3 text-gray-600",children:t?r.jsx(b,{size:18}):r.jsx(f,{size:18})})]}),e.touched.confirmPassword&&e.errors.confirmPassword&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.confirmPassword}),r.jsx("input",{name:"phone",type:"text",placeholder:"رقم الهاتف (اختياري)",className:`w-full p-3 border rounded  ${e.touched.phone&&e.errors.phone?"border-red-500":"border-blue-800"}`,value:e.values.phone,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.phone&&e.errors.phone&&r.jsx("div",{className:"text-red-500 text-sm",children:e.errors.phone}),r.jsx("button",{type:"submit",className:"w-full p-3 bg-blue-800 text-white rounded hover:bg-blue-900 transition",disabled:l,children:l?"جاري التسجيل...":"تسجيل"})]}),r.jsxs("p",{className:"mt-4 text-gray-600",children:["لديك حساب بالفعل؟"," ",r.jsx(w,{to:"/login",className:"text-blue-800 hover:underline",children:"تسجيل الدخول"})]})]})};export{q as default};
