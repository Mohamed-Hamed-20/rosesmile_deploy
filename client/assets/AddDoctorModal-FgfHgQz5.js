import{r as l,j as e,z as x,y as o}from"./index-BzNwyTTe.js";import{S as D,L}from"./sweetalert2.esm.all-Cxdeaupf.js";import{A as z}from"./index-Dn6cvt5g.js";import{M as E}from"./minus-lsm2JIKY.js";const I=({isOpen:b,onClose:d,addDoctor:y})=>{const[a,n]=l.useState({name:"",specialization:"",description:[],image:null}),[h,m]=l.useState(null),[i,g]=l.useState(!1),[u,p]=l.useState("");l.useEffect(()=>{const t=s=>{s.ctrlKey&&s.shiftKey&&s.key.toLowerCase()==="x"&&(s.preventDefault(),d())};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[]);const f=(t,s)=>{n({...a,[s]:t.target.value})},j=t=>{const s=t.target.files[0];s&&(m(URL.createObjectURL(s)),n({...a,image:s}))},v=()=>{const t=u.trim();t.length>=3?(n(s=>({...s,description:[...s.description,t]})),p("")):o.error("الوصف يجب أن يكون 3 أحرف على الأقل")},w=t=>{t.key==="Enter"&&u.trim()&&(t.preventDefault(),v())},N=(t,s)=>{const r=a[t].filter((c,C)=>C!==s);n(c=>({...c,[t]:r}))},k=async t=>{if(t.preventDefault(),!a.image){o.error("يرجى اختيار صورة الطبيب");return}g(!0);const s=new FormData;s.append("name",a.name),s.append("specialization",a.specialization),a.description.forEach((r,c)=>{s.append(`description[${c}]`,r)}),s.append("image",a.image);try{const r=await y(s);r.success?(o.success(r.message),d(),n({name:"",specialization:"",description:[],image:null}),m(null)):o.error(r.message||"حدث خطأ أثناء إضافة الطبيب")}catch(r){o.error(r.message||"حدث خطأ أثناء إضافة الطبيب")}finally{g(!1)}};return b?e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/60 flex items-center justify-center z-500 p-4",children:e.jsxs(x.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-full max-h-[95vh] overflow-y-auto p-8 md:p-10",dir:"rtl",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-800 border-b pb-4",children:"إضافة طبيب جديد"}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 mt-11",children:"اسم الطبيب"}),e.jsx("input",{type:"text",value:a.name,onChange:t=>f(t,"name"),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-right mt-2 ",required:!0,disabled:i})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 mt-11",children:"التخصص"}),e.jsx("input",{type:"text",value:a.specialization,onChange:t=>f(t,"specialization"),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-right mt-2 ",required:!0,disabled:i})]}),e.jsx("div",{className:"w-full flex justify-center items-start mt-4",children:e.jsxs("div",{className:"relative aspect-[3/4] w-48 overflow-hidden rounded-xl shadow-md border-2 border-dashed border-gray-300 hover:border-blue-500 cursor-pointer group transition-all duration-200 ml-auto mr-auto",onClick:()=>document.getElementById("imageUpload").click(),children:[h?e.jsxs("div",{className:"w-full h-full relative group",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover object-top"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"تغيير الصورة"})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-4 h-full",children:[e.jsx("div",{className:"mb-2 text-gray-400",children:e.jsx("svg",{className:"h-8 w-8",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("p",{className:"text-xs text-gray-500",children:"اضغط لرفع صورة"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"PNG, JPG، حتى 10MB"})]}),e.jsx("input",{type:"file",id:"imageUpload",onChange:j,className:"hidden",accept:"image/*",disabled:i})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الوصف"}),e.jsx("textarea",{rows:3,value:u,onChange:t=>p(t.target.value),onKeyDown:w,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:i,placeholder:"اكتب الوصف واضغط Enter لإضافته"}),a.description.length>0&&e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["عدد: ",a.description.length]}),e.jsx("button",{type:"button",onClick:async()=>{(await D.fire({title:"هل أنت متأكد؟",text:"سيتم مسح جميع الأوصاف المدخلة.",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم، امسح الكل",cancelButtonText:"إلغاء",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed&&n(s=>({...s,description:[]}))},className:"text-red-600 hover:text-red-800 font-medium text-sm transition cursor-pointer",disabled:i,children:"مسح الكل"})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto space-y-2 mt-2",children:e.jsx(z,{children:a.description.map((t,s)=>e.jsxs(x.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right break-words whitespace-pre-wrap",children:t}),e.jsx("button",{type:"button",onClick:()=>N("description",s),className:"text-red-600 hover:text-red-800 mt-1",disabled:i,children:e.jsx(E,{})})]},s))})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("button",{type:"button",onClick:d,title:"يمكنك أيضًا الإغلاق باستخدام Ctrl + Shift + X",className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition cursor-pointer",disabled:i,children:"إغلاق"}),e.jsx("button",{type:"button",onClick:()=>{n({name:"",specialization:"",description:[],image:null}),m(null),p("")},className:"px-6 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition cursor-pointer",disabled:i,children:"إعادة ضبط"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 cursor-pointer",disabled:i,children:i?e.jsx(L,{className:"animate-spin",size:20}):"تاكيد الإضافة"})]})]})]})},"Add-Doctor-Modal"):null};export{I as default};
