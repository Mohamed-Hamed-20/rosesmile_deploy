import{r as c,j as e,D as N,E as M,M as L,F,z as j,f as P,i as U,K as O,R as A,P as K,T as R,H as _}from"./index-DJ4Ad8or.js";import{u as B}from"./useSections-Bc5HDoC7.js";const $=({isOpen:S,onClose:w,sections:C,addsection:u})=>{const[r,i]=c.useState({title:"",subTitle:"",image:null,description:[],features:[]}),[b,h]=c.useState(null),[n,f]=c.useState(!1),[p,m]=c.useState(""),[x,g]=c.useState(""),y=(t,l)=>{i({...r,[l]:t.target.value})},T=()=>{p.trim()&&(i({...r,description:[...r.description,p.trim()]}),m(""))},D=()=>{x.trim()&&(i({...r,features:[...r.features,x.trim()]}),g(""))},E=t=>{t.key==="Enter"&&p.trim()&&(t.preventDefault(),T())},k=t=>{t.key==="Enter"&&x.trim()&&(t.preventDefault(),D())},I=t=>{const l=t.target.files[0];l&&(h(URL.createObjectURL(l)),i({...r,image:l}))},s=(t,l)=>{const d=r[t].filter((a,z)=>z!==l);i({...r,[t]:d})},o=async t=>{t.preventDefault(),f(!0);const l=new FormData;l.append("title",r.title),l.append("subTitle",r.subTitle),r.image&&l.append("image",r.image),r.description.forEach((d,a)=>{d&&l.append(`description[${a}]`,d)}),p.trim()&&l.append(`description[${r.description.length}]`,p.trim()),r.features.forEach((d,a)=>{d&&l.append(`features[${a}]`,d)}),x.trim()&&l.append(`features[${r.features.length}]`,x.trim());try{const d=await u(l);console.log(d),d.success?(j.success(d.message),w(),i({title:"",subTitle:"",sectionId:"",image:null,description:[],features:[]}),h(null),m(""),g("")):j.error(d.errors.message||"حدث خطأ أثناء إضافة القسم")}catch(d){j.error(d.message||"حدث خطأ أثناء إضافة القسم")}finally{f(!1)}};return S?e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/60 flex items-center justify-center z-500 p-4",children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-2xl w-full h-full max-h-screen overflow-auto p-8 md:p-12",dir:"rtl",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-right text-gray-800 border-b pb-4",children:"إضافة قســم جديدة"}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-10",children:e.jsxs("form",{onSubmit:o,className:"w-full grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"flex gap-10",children:e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"العنوان"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>y(t,"title"),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-right focus:outline-none",required:!0,disabled:n})]})}),e.jsx("div",{className:"md:col-span-1 row-span-3 flex justify-center",children:e.jsxs("div",{className:"relative w-100 lg:h-70 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-100 transition",onClick:()=>document.getElementById("imageUpload").click(),children:[b?e.jsx("img",{src:b,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-gray-400 text-lg text-center",children:"اضغط لرفع صورة"}),e.jsx("input",{type:"file",id:"imageUpload",onChange:I,className:"hidden",accept:"image/*",disabled:n})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"العنوان الفرعي"}),e.jsx("input",{type:"text",value:r.subTitle,onChange:t=>y(t,"subTitle"),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-right focus:outline-none",disabled:n})]}),e.jsxs("div",{className:"",dir:"rtl",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"الوصف"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("textarea",{rows:3,value:p,onChange:t=>m(t.target.value),onKeyDown:E,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:n,placeholder:"اكتب الوصف واضغط Enter لإضافته"})}),e.jsx(M,{children:r.description.map((t,l)=>e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2 mt-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right",children:t}),e.jsx("button",{type:"button",onClick:()=>s("description",l),className:"text-red-600 hover:text-red-800 mt-1",disabled:n,children:e.jsx(L,{})})]},l))})]}),e.jsxs("div",{className:"md:col-span-2",dir:"rtl",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"المميزات"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("textarea",{rows:3,value:x,onChange:t=>g(t.target.value),onKeyDown:k,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:n,placeholder:"اكتب ميزة واضغط Enter لإضافتها"})}),e.jsx(M,{children:r.features.map((t,l)=>e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2 mt-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right",children:t}),e.jsx("button",{type:"button",onClick:()=>s("features",l),className:"text-red-600 hover:text-red-800 mt-1",disabled:n,children:e.jsx(L,{})})]},l))})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-between items-center mt-8",children:[e.jsx("button",{type:"button",onClick:w,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition cursor-pointer",disabled:n,children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 cursor-pointer",disabled:n,children:n?e.jsx(F,{className:"animate-spin",size:20}):"إضافة"})]})]})})]})},"Add-Service-Modal"):null},q=({isOpen:S,onClose:w,sections:C,section:u,updatesection:r})=>{const[i,b]=c.useState({title:"",subTitle:"",description:[],features:[]}),[h,n]=c.useState(""),[f,p]=c.useState(""),[m,x]=c.useState(!1);c.useEffect(()=>{var s,o;u&&b({title:u.title||"",subTitle:u.subTitle||"",description:((s=u.description)==null?void 0:s.length)>0?u.description:[],features:((o=u.features)==null?void 0:o.length)>0?u.features:[]})},[u]);const g=(s,o)=>{b({...i,[o]:s.target.value})},y=()=>{h.trim()&&(b({...i,description:[...i.description,h.trim()]}),n(""))},T=()=>{f.trim()&&(b({...i,features:[...i.features,f.trim()]}),p(""))},D=s=>{s.key==="Enter"&&h.trim()&&(s.preventDefault(),y())},E=s=>{s.key==="Enter"&&f.trim()&&(s.preventDefault(),T())},k=(s,o)=>{const t=i[s].filter((l,d)=>d!==o);b({...i,[s]:t})},I=async s=>{s.preventDefault(),x(!0);const o={title:i.title,subTitle:i.subTitle,description:[...i.description.filter(t=>t.trim()!==""),...h.trim()?[h.trim()]:[]],features:[...i.features.filter(t=>t.trim()!==""),...f.trim()?[f.trim()]:[]]};try{const t=await r(u._id,o);t.success?(j.success(t.message),w(),n(""),p("")):j.error(t.message||"حدث خطأ أثناء تعديل الخدمة")}catch(t){j.error(t.message||"حدث خطأ أثناء تعديل الخدمة")}finally{x(!1)}};return!S||!u?null:e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-500 p-4 md:mt-20",children:e.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-2xl w-full h-full max-h-screen overflow-auto p-8 md:p-12",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-6 text-right",children:"تعديل  القـســـم"}),e.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-right",children:"العنوان الفرعي"}),e.jsx("input",{type:"text",value:i.subTitle,onChange:s=>g(s,"subTitle"),className:"mt-1 block w-full p-2 border border-gray-500 rounded-md focus:outline-none text-right",disabled:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-right",children:"العنوان"}),e.jsx("input",{type:"text",value:i.title,onChange:s=>g(s,"title"),className:"mt-1 block w-full p-2 border border-gray-500 rounded-md focus:outline-none text-right",required:!0,disabled:m})]}),e.jsx("div",{}),e.jsxs("div",{className:"md:col-span-2",dir:"rtl",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"الوصف"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("textarea",{rows:3,value:h,onChange:s=>n(s.target.value),onKeyDown:D,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:m,placeholder:"اكتب الوصف واضغط Enter لإضافته"})}),e.jsx(M,{children:i.description.map((s,o)=>e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2 mt-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right",children:s}),e.jsx("button",{type:"button",onClick:()=>k("description",o),className:"text-red-600 hover:text-red-800 mt-1",disabled:m,children:e.jsx(L,{})})]},o))})]}),e.jsxs("div",{className:"md:col-span-2",dir:"rtl",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"المميزات"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("textarea",{rows:3,value:f,onChange:s=>p(s.target.value),onKeyDown:E,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:m,placeholder:"اكتب ميزة واضغط Enter لإضافتها"})}),e.jsx(M,{children:i.features.map((s,o)=>e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2 mt-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right",children:s}),e.jsx("button",{type:"button",onClick:()=>k("features",o),className:"text-red-600 hover:text-red-800 mt-1",disabled:m,children:e.jsx(L,{})})]},o))})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 space-x-reverse mt-4",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-all duration-200 cursor-pointer",disabled:m,children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 cursor-pointer flex items-center gap-2",disabled:m,children:m?e.jsx(F,{className:"animate-spin",size:20}):"حفظ التعديلات"})]})]})]})},"Edit-Service-Modal")},G=({isOpen:S,onClose:w,section:C,updatesectionImage:u})=>{const[r,i]=c.useState(null),[b,h]=c.useState(null),[n,f]=c.useState(!1),p=x=>{const g=x.target.files[0];g&&(h(URL.createObjectURL(g)),i(g))},m=async x=>{if(x.preventDefault(),!r){j.error("يرجى اختيار صورة للتحديث");return}f(!0);const g=new FormData;g.append("image",r);try{const y=await u(C._id,g);y.success?j.success(y.message):j.error(y.message),w(),i(null),h(null)}catch(y){j.error(y.message)}finally{f(!1)}};return S?e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3},className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-6 text-right",children:"تحديث الصورة"}),e.jsxs("form",{onSubmit:m,children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsxs("div",{className:"relative w-full h-64 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-100 transition",onClick:()=>document.getElementById("imageUpload").click(),children:[b?e.jsx("img",{src:b,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-gray-400 text-lg text-center",children:"اضغط لرفع صورة"}),e.jsx("input",{type:"file",id:"imageUpload",onChange:p,className:"hidden",accept:"image/*",disabled:n})]})}),e.jsxs("div",{className:"flex justify-end gap-2 space-x-reverse mt-4",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-all duration-200 cursor-pointer",disabled:n,children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 cursor-pointer flex items-center gap-2",disabled:n,children:n?e.jsx(F,{className:"animate-spin",size:20}):"تحديث"})]})]})]})},"image-modal"):null},Q=()=>{const[S,w]=P(),{sections:C,loading:u,addSection:r,updateSection:i,updatesectionImage:b,deleteSection:h}=B(),n=S.get("search")||"",[f,p]=c.useState(n),[m,x]=c.useState(!1),[g,y]=c.useState(!1),[T,D]=c.useState(!1),[E,k]=c.useState(null),[I,s]=c.useState(null),o=a=>{k(a),y(!0)},t=a=>{k(a),D(!0)},l=async a=>{if((await _.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"نعم، احذف!",cancelButtonText:"إلغاء"})).isConfirmed){s(a);try{const v=await h(a);v.success?j.success(v.message):j.error(v.message)}catch(v){j.error(v.message||"حدث خطأ أثناء الحذف")}finally{s(null)}}},d=a=>{p(a),w(z=>{const v=new URLSearchParams(z);return a?(v.set("search",a),v.set("page","1")):v.delete("search"),v})};return c.useEffect(()=>{const a=S.get("search")||"";p(a)},[S]),e.jsx("div",{className:"p-4 sm:p-6 bg-gray-100 min-h-screen overflow-x-auto",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-md",dir:"rtl",children:[e.jsx(U,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:f,onChange:a=>d(a.target.value),placeholder:"ابحث عن اقسام...",className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none text-right"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-all duration-200 w-full sm:w-auto",children:[e.jsx(O,{size:20}),"إضافة قســم جديدة"]})]}),e.jsx($,{isOpen:m,onClose:()=>x(!1),sections:C,addsection:r}),e.jsx(q,{isOpen:g,onClose:()=>y(!1),sections:C,section:E,updatesection:i}),e.jsx(G,{isOpen:T,onClose:()=>D(!1),section:E,updatesectionImage:b}),u?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(F,{className:"animate-spin text-blue-500",size:32})}):e.jsx(A.Fragment,{children:e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-right",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-2 sm:px-4 py-3 text-xs font-medium text-gray-500 tracking-wider whitespace-nowrap",children:"الصورة"}),e.jsx("th",{className:"text-center px-2 sm:px-4 py-3 text-xs font-medium text-gray-500 tracking-wider whitespace-nowrap",children:"العنوان"}),e.jsx("th",{className:"text-center px-2 sm:px-4 py-3 text-xs font-medium text-gray-500 tracking-wider whitespace-nowrap",children:"العنون الفرعى"}),e.jsx("th",{className:"text-center px-2 sm:px-4 py-3 text-xs font-medium text-gray-500 tracking-wider whitespace-nowrap",children:"تاريخ الإنشاء"}),e.jsx("th",{className:"text-center px-2 sm:px-4 py-3 text-xs font-medium text-gray-500 tracking-wider whitespace-nowrap",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.length>0?C.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 sm:px-4 py-4 whitespace-nowrap text-sm text-gray-900 text-center",children:e.jsx("img",{src:a.image.thumbnailMedium,alt:a.title,className:"w-10 h-10 sm:w-12 sm:h-12 object-cover rounded cursor-pointer mx-auto",onClick:()=>t(a)})}),e.jsx("td",{className:"px-2 sm:px-4 py-4 whitespace-nowrap text-sm text-gray-900 max-w-[150px] sm:max-w-[200px] truncate",children:a.title}),e.jsx("td",{className:"px-2 sm:px-4 py-4 whitespace-nowrap text-sm text-gray-500 max-w-[120px] sm:max-w-[150px] truncate",children:a.subTitle}),e.jsx("td",{className:"px-2 sm:px-4 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(a.createdAt).toLocaleDateString("ar-EG")}),e.jsxs("td",{className:"px-2 sm:px-4 py-8 whitespace-nowrap text-sm flex gap-5 items-center justify-center",children:[e.jsx("button",{onClick:()=>o(a),className:"text-blue-600 hover:text-blue-800 cursor-pointer",title:"تعديل الخدمة",children:e.jsx(K,{size:16})}),e.jsx("button",{onClick:()=>l(a._id),className:"text-red-600 hover:text-red-800 cursor-pointer",title:"حذف الخدمة",disabled:I===a._id,children:I===a._id?e.jsx(F,{className:"animate-spin",size:16}):e.jsx(R,{size:16})})]})]},a._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-2 sm:px-4 py-4 text-center text-sm text-gray-500",children:"لا توجد خدمات متاحة"})})})]})})})]})})};export{Q as default};
