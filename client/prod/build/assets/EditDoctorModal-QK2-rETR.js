import{r as l,j as e,D as m,H as C,E as k,M as E,F as z,z as c}from"./index-DJ4Ad8or.js";const L=({isOpen:b,onClose:d,doctor:a,updateDoctor:y})=>{const[i,o]=l.useState({name:"",specialization:"",description:[]}),[r,x]=l.useState(!1),[u,p]=l.useState("");l.useEffect(()=>{a&&o({name:a.name||"",specialization:a.specialization||"",description:Array.isArray(a.description)?a.description:[a.description]})},[a]),l.useEffect(()=>{const t=s=>{s.ctrlKey&&s.shiftKey&&s.key.toLowerCase()==="x"&&(s.preventDefault(),d())};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[]);const f=(t,s)=>{o({...i,[s]:t.target.value})},g=()=>{const t=u.trim();if(t.length<3){c.error("الوصف يجب أن يحتوي على 3 أحرف على الأقل");return}o(s=>({...s,description:[...s.description,t]})),p("")},j=t=>{t.key==="Enter"&&u.trim()&&(t.preventDefault(),g())},w=(t,s)=>{const n=i[t].filter((h,D)=>D!==s);o(h=>({...h,[t]:n}))},v=()=>{o(t=>({...t,description:[]}))},N=async t=>{t.preventDefault(),x(!0);const s={name:i.name,specialization:i.specialization,description:i.description};try{const n=await y(a._id,s);n.success?(c.success(n.message),d()):c.error(n.message||"حدث خطأ أثناء تعديل الطبيب")}catch(n){c.error(n.message||"حدث خطأ أثناء تعديل الطبيب")}finally{x(!1)}};return!b||!a?null:e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black/60 flex items-center justify-center z-500 p-4",children:e.jsxs(m.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[95vh] min-h-[90vh] overflow-y-auto flex flex-col box-border",dir:"rtl",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-800 border-b pb-4 px-8 pt-8",children:"تعديل بيانات الطبيب"}),e.jsxs("form",{onSubmit:N,className:"flex-grow space-y-6 px-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الطبيب"}),e.jsx("input",{type:"text",value:i.name,onChange:t=>f(t,"name"),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-right",required:!0,disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"التخصص"}),e.jsx("input",{type:"text",value:i.specialization,onChange:t=>f(t,"specialization"),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-right",required:!0,disabled:r})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"الوصف"}),e.jsx("textarea",{rows:3,value:u,onChange:t=>p(t.target.value),onKeyDown:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 text-right focus:ring-blue-500 resize-none focus:outline-none",disabled:r,placeholder:"اكتب الوصف واضغط Enter لإضافته"}),i.description.length>0&&e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["عدد: ",i.description.length]}),e.jsx("button",{type:"button",onClick:async()=>{(await C.fire({title:"هل أنت متأكد؟",text:"سيتم مسح جميع الأوصاف المدخلة.",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم، امسح الكل",cancelButtonText:"إلغاء",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed&&v()},className:"text-red-600 hover:text-red-800 font-medium text-sm cursor-pointer transition",disabled:r,children:"مسح الكل"})]}),e.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 mt-2",children:e.jsx(k,{children:i.description.map((t,s)=>e.jsxs(m.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2},className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-full p-3 bg-gray-100 rounded-lg text-right break-words whitespace-pre-wrap",children:t}),e.jsx("button",{type:"button",onClick:()=>w("description",s),className:"text-red-600 hover:text-red-800 mt-1",disabled:r,children:e.jsx(E,{})})]},s))})})]}),e.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[e.jsx("button",{type:"button",onClick:d,title:"يمكنك أيضًا الإغلاق باستخدام Ctrl + Shift + X",className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition cursor-pointer",disabled:r,children:"إغلاق"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 cursor-pointer",disabled:r,children:r?e.jsx(z,{className:"animate-spin",size:20}):"حفظ التعديلات"})]}),e.jsx("div",{className:"h-4"})]})]})},"Edit-Doctor-Modal")};export{L as default};
